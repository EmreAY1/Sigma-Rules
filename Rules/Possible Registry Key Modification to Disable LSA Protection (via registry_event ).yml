title: Possible Registry Key Modification to Disable LSA Protection (via registry_event )
status: stable
description: This rule detects Registry Key Modification to Disable LSA Protection.The LSA controls and manages user rights information, password hashes and other important bits of information in memory. Attacker tools, such as mimikatz, rely on accessing this content to scrape password hashes or clear-text passwords. Enabling LSA Protection configures Windows to control the information stored in memory in a more secure fashion - specifically, to prevent non-protected processes from accessing that data
author: Emre Ay
references:
- https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562/T1562.md#atomic-test-1---windows-disable-lsa-protection
logsource:
  product: windows
  category: registry_event
detection:
  selection:
    TargetObject|endswith:
    - 'HKLM\SYSTEM\CurrentControlSet\Control\LSA\RunAsPPL'
    Details:
    - 'DWORD (0x00000000)'
  condition: selection
falsepositives:
- Unlikely
tags:
- attack.defense_evasion
- attack.t1112
level: high
