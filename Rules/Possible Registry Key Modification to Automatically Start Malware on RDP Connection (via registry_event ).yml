title: Possible Registry Key Modification to Automatically Start Malware on RDP Connection (via registry_event )
status: stable
description: This rule detects the threat actors that attempt to enable associated registry key. By modifying this key, remote desktop services sessions automatically execute the specified malware on RDP Connection.
author: Emre Ay
references:
- https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1112/T1112.md#atomic-test-86---modify-rdp-tcp-initial-program-registry-entry
logsource:
  product: windows
  category: registry_event
detection:
  selection:
    TargetObject|endswith:
    - '\Control\Terminal Server\WinStations\RDP-Tcp\fInheritInitialProgram'
    Details:
    - 'DWORD (0x00000001)'
  condition: selection
falsepositives:
- Unlikely
tags:
- attack.defense_evasion
- attack.t1112
level: medium
