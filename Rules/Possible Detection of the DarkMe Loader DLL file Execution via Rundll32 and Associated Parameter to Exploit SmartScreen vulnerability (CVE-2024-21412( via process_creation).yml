title: Possible Detection of the DarkMe Loader DLL file Execution via Rundll32 and Associated Parameter to Exploit SmartScreen vulnerability (CVE-2024-21412( via process_creation)
status: stable
description: This rule detects suspicious execution of rundll32.exe via associated parameter that are related with The APT group Water Hydra which has been exploiting the Microsoft Defender SmartScreen vulnerability (CVE-2024-21412) in its campaigns.
references:
- https://www.dnif.it/darc-notes/cve-2024-21412
- https://www.trendmicro.com/en_us/research/24/b/cve202421412-water-hydra-targets-traders-with-windows-defender-s.html
author: Emre Ay
logsource:
  product: windows
  category: process_creation
detection:
  selection:
    Image|endswith:
    - 'rundll32.exe'
    CommandLine|contains|all:
    - '.dll'
    - 'RunDllEntryPointW'
  condition: selection
falsepositives:
- Unlikely
tags:
- attack.execution
- attack.defense_evasion
- attack.t1218.011
level: high
